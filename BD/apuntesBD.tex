% ============================================================================
% DOCUMENTO: APUNTES DE SOSTENIBILIDAD APLICADA AL SISTEMA PRODUCTIVO
% ============================================================================
% Descripción: Apuntes académicos estructurados en partes, unidades y secciones
%              sobre sostenibilidad en entornos empresariales y profesionales
% Autor:       Francisco IndexOutOfBounds
% Curso:       2025/2026
% Versión:     1.0
% ============================================================================

% ============================================================================
% CONFIGURACIÓN DEL DOCUMENTO
% ============================================================================
% Clase: book (documento tipo libro)
% - 11pt: Tamaño de fuente base (11 puntos)
% - titlepage: Crea una página de título personalizada
\documentclass[11pt,titlepage,twoside]{book}

% ============================================================================
% PAQUETES MATEMÁTICOS Y SÍMBOLOS
% ============================================================================
% amsmath: Entornos mejorados para ecuaciones matemáticas
% amssymb: Símbolos matemáticos adicionales (American Mathematical Society)
% amsfonts: Fuentes matemáticas especiales
% latexsym: Símbolos LaTeX adicionales
\usepackage{amsmath,amssymb,amsfonts,latexsym}

% ============================================================================
% CODIFICACIÓN Y MULTIIDIOMA
% ============================================================================
% Codificación UTF-8: Permite usar caracteres acentuados y especiales directamente
\usepackage[utf8]{inputenc}
% Soporte para español e inglés: Define reglas de idiomas para separación de sílabas
% y formato de texto según el idioma
\usepackage[english,spanish,es-tabla]{babel}

% ============================================================================
% GRÁFICOS E IMÁGENES
% ============================================================================
% graphicx: Paquete para incrustar y manipular imágenes en formato JPG, PNG, PDF
% Proporciona comandos como \includegraphics para insertar imágenes con control
% sobre el tamaño, rotación y otros parámetros visuales
\usepackage{graphicx}
\usepackage{xcolor}

% lipsum: Paquete para generar texto de prueba (Lorem Ipsum)
% Útil para rellenar documentos durante el diseño y maquetación
% Se usa generalmente con \lipsum[1-3] para insertar párrafos de ejemplo
\usepackage{lipsum}

% ============================================================================
% HIPERVÍNCULOS Y REFERENCIAS
% ============================================================================
% Habilita hipervínculos interactivos en el documento PDF
\usepackage{hyperref}
% Configuración personalizada de hipervínculos:
\hypersetup{
    colorlinks=true,       % Activar colores en enlaces (en lugar de cajas)
    linkcolor=blue,        % Color azul para referencias internas (\ref, \cite)
    filecolor=magenta,     % Color magenta para enlaces a archivos externos
    urlcolor=cyan,         % Color cian para URLs web
    pdftitle={Sostenibilidad Aplicada al Sistema Productivo}, % Metadato: título PDF
    pdfpagemode=FullScreen, % Mostrar el PDF en modo pantalla completa al abrirlo
}
% Usar el mismo estilo de fuente para URLs que el resto del texto
\urlstyle{same}

% ============================================================================
% CONFIGURACIÓN DE MÁRGENES Y LAYOUT
% ============================================================================
% Paquete geometry: Control preciso de dimensiones y márgenes de página
\usepackage{geometry}
% Configuración:
% - a4paper: Tamaño de papel A4 (210x297 mm)
% - left=30mm, right=25mm: Márgenes laterales
% - top=30mm, bottom=30mm: Márgenes superior e inferior
\geometry{
  a4paper,
  left=20mm,
  right=20mm,
  top=30mm,
  bottom=25mm
}

% ============================================================================
% ENCABEZADOS Y PIES DE PÁGINA
% ============================================================================
% fancyhdr: Permite personalizar encabezados y pies de página
% fancybox: Proporciona cajas decorativas y marcos para texto
\usepackage{fancyhdr}
% Configuración de encabezados y pies de página:
\fancyhf{} % Limpiar encabezados y pies predeterminados
\lhead[\thepage]{Apuntes}
\rhead[Sostenibilidad Aplicada al Sistema Productivo]{\thepage}

\pagestyle{fancy}

\usepackage{emptypage}

\usepackage{fancybox}

% ============================================================================
% ESTILOS DE CAPÍTULOS Y SECCIONES
% ============================================================================
% fncychap: Estilos decorativos para títulos de capítulos
% [Bjornstrup]: Estilo elegante con líneas y formateo especial
\usepackage[Bjornstrup]{fncychap}

% titlesec: Control avanzado sobre el formato de títulos de secciones
% y subsecciones (espaciado, color, numeración, etc.)
\usepackage{titlesec}

% ============================================================================
% CONFIGURACIÓN DE ESTILOS Y FORMATEO
% ============================================================================

% INDENTACIÓN DE PÁRRAFOS
% ============================================================================
% Eliminar indentación automática de párrafos (primera línea)
% Por defecto, LaTeX indenta la primera línea de cada párrafo
% Establecer \parindent=0pt elimina esta indentación en todo el documento
% Los párrafos se separan únicamente por espaciado vertical (\vspace)
\setlength{\parindent}{0pt}

% ============================================================================
% FORMATO DE PARTES (TRIMESTRES)
% ============================================================================
% Las partes representan los trimestres del curso académico
% Define el aspecto visual de los títulos de partes
%
% SINTAXIS: \titleformat{nivel}[forma]{formato}{etiqueta}{espacio}{código_antes}[código_después]
%
% Parámetros de configuración:
% - nivel: \part (nivel jerárquico a personalizar)
% - [frame]: Encierra el título en un recuadro decorativo
% - \normalfont: Fuente normal (sin variaciones de estilo previas)
% - \filleft\footnotesize\enspace\bfseries TRIMESTRE \thepart\enspace: 
%   * \filleft: Alinea el contenido a la izquierda dentro del espacio disponible
%   * \footnotesize: Tamaño de fuente pequeño para la palabra "TRIMESTRE"
%   * \bfseries: Texto en negrita
%   * \thepart: Número de la parte (1, 2, 3, etc.)
% - 8pt: Espacio entre la etiqueta y el título principal
% - \Large\bfseries\filcenter: Título principal en grande, negrita y centrado
\titleformat{\part}[frame]{\normalfont}{\filleft\footnotesize\enspace\bfseries TRIMESTRE \arabic{part}\enspace}{8pt}{\Large\bfseries\filcenter}[]

% ============================================================================
% FORMATO DE SECCIONES (UNIDADES DENTRO DE PARTES)
% ============================================================================
% Las secciones representan las unidades temáticas dentro de cada trimestre
% Se numeran de forma independiente en todo el documento (1, 2, 3...)
% en lugar de la numeración jerárquica (1.1, 1.2, 2.1, etc.)
%
% Cambio de numeración:
\renewcommand{\thesection}{\arabic{section}}
% \arabic{section}: Muestra solo números ordinales sin la parte anidada
%
% Personalización del formato de títulos de sección:
% - [block]: El título ocupa todo el ancho disponible en bloque
% - \normalfont\bfseries: Fuente normal en negrita
% - {\doublebox{\thesection}}: Número de sección dentro de un doble recuadro
% - .5em: Espacio entre el número recuadrado y el título del texto
% - []: Código ejecutado después del título (en este caso, vacío)
% - [\titlerule\vspace*{4pt}]: Dibuja una línea horizontal bajo el título con 4pt de espacio
\titleformat{\section}[block]{\normalfont\bfseries}{\doublebox{\thesection}}{.5em}{}[\titlerule\vspace*{4pt}]

% ============================================================================
% FORMATO DE SUBSECCIONES Y SUBSUBSECCIONES
% ============================================================================
% Subsecciones: Temas secundarios dentro de las unidades (secciones)
% Formato personalizado con alineación y estilos específicos:
% - [hang]: El título cuelga bajo el número (el número está solo en la primera línea)
% - \bf\large\raggedright: Texto en negrita, tamaño grande, alineado a la derecha
% - {\filleft\thesubsection.}: Número de subsección alineado a la izquierda con punto
% - .5em: Espacio entre número y título
%
% NOTA: \raggedright y \filleft son en este contexto complementarios:
% - \filleft: Llena el espacio antes (alinea el número a la izquierda)
% - \raggedright: El título cuelga a la derecha después del espacio
\titleformat{\subsection}[hang]{\bf\large\raggedright}{\filleft\thesubsection.}{.5em}{}

% Subsubsecciones: Subdivisiones de las subsecciones (nivel 4 de profundidad)
% Formato similar al de subsecciones pero alineadas a la izquierda:
% - [hang]: Estructura colgante igual que subsecciones
% - \bf\large\raggedleft: Negrita, grande, alineado a la izquierda
% - {\thesubsubsection}: Número sin punto adicional
% - 0em: Sin espacio entre número y título (pegado inmediatamente)
\titleformat{\subsubsection}[hang]{\bf\large\raggedleft}{\thesubsubsection}{0em}{}

% ============================================================================
% CORRECCIÓN DE REFERENCIAS DE PÁGINA PARA PARTES
% ============================================================================
% Problema: La tabla de contenidos puede referenciar una página diferente a donde
% realmente aparece el título de \part, especialmente con saltos de página complejos.
%
% Solución: Redefinir el comando \@endpart para usar \cleardoublepage
% que sincroniza correctamente las referencias de página con el contenido.
% \cleardoublepage asegura:
% - Salto a página nueva
% - Sincronización correcta de referencias de página
% - Comportamiento apropiado en documentos de dos caras
\makeatletter
\renewcommand{\@endpart}{%
    \vfil\null
    \cleardoublepage
}
\makeatother

% ============================================================================
% INICIO DEL DOCUMENTO PRINCIPAL
% ============================================================================
% Todo el contenido se coloca entre \begin{document} y \end{document}

\begin{document}

\setlength{\headheight}{15pt}

% ============================================================================
% PÁGINA DE TÍTULO PERSONALIZADA
% ============================================================================
% Crea una portada atractiva con:
% - Título principal del documento
% - Imagen de portada (portada.jpg)
% - Nombre del autor
% - Información del curso
\begin{titlepage}
  % Centra el contenido horizontalmente
  \centering

  % Título pequeño
  {\LARGE \textsc{Apuntes}\par}
  \vspace{1em}

  % Título principal en negrita
  {\huge\bfseries Bases de Datos\par}
  \vfill

  % Imagen de portada escalada al ancho total de la página
  \includegraphics[width=\textwidth]{img/portada.png}
  \vfill

  % Información del autor y curso al final
  {\Large Francisco IndexOutOfBounds\par}
  \vspace{0.5em}
  \textsc{Curso 2025/2026}
\end{titlepage}


% ============================================================================
% TABLA DE CONTENIDOS
% ============================================================================
% Genera automáticamente un índice con todos los capítulos, secciones y subsecciones
% Los números de página se vinculan a las respectivas secciones en el PDF
\tableofcontents

% ============================================================================
% CONTENIDO PRINCIPAL DEL DOCUMENTO
% ============================================================================
% El contenido se organiza en partes (trimestres) y unidades

% PRIMER TRIMESTRE: SOSTENIBILIDAD EN EL ENTORNO EMPRESARIAL Y PROFESIONAL
% ============================================================================
% \cleardoublepage: Asegura que la parte comience en una página nueva
% y sincroniza correctamente la referencia en la tabla de contenidos
% Define la primera parte del documento
% El contenido será numerado automáticamente como "TRIMESTRE 1"
\cleardoublepage
\part[Trimestre 1]{Contextualización y Diseño de Bases de Datos}

% Inclusión de archivos LaTeX externos:
% \input{ruta/archivo.tex} inserta el contenido del archivo en esta posición
% Las unidades 1 y 2 corresponden al primer trimestre
\input{units/unit1.tex}
\input{units/unit2.tex}

% SEGUNDO TRIMESTRE
% ============================================================================
% \cleardoublepage: Asegura que la parte comience en una página nueva
% y sincroniza correctamente la referencia en la tabla de contenidos
\cleardoublepage
\part[Trimestre 2]{}

% Inclusión de la unidad 3 (segundo trimestre)
\input{units/unit3.tex}

% ============================================================================
% FIN DEL DOCUMENTO
% ============================================================================

\end{document}